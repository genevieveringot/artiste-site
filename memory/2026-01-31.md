# 2026-01-31 — Media Stack Refonte

## Session avec Nicolas (Discord)

### Questions initiales
- IP Jellyfin : `192.168.1.106:8096`
- Film Anaconda (2025) demandé mais pas dispo — aucune release sur les trackers pour l'instant

### Grande refonte de la stack média

Nicolas m'a envoyé un guide complet et m'a demandé de réorganiser la stack en s'en inspirant.

#### Changements effectués :
1. **Supprimé Overseerr** — doublon avec Jellyseerr
2. **Jellyseerr** — changé port 5056 → 5055 (standard)
3. **Ajouté Listenarr** — stats de visionnage, port 8787
4. **Custom Formats Radarr/Sonarr** :
   - MULTi : +100 points (favorise multilingue)
   - VF Only (No MULTi) : -10000 points (rejette VF seul)
   - Appliqués au profil HD-1080p

#### Scripts de monitoring créés :
- `mount_watchdog.sh` — surveille mount rclone, redémarre Decypharr si down
- `repair-monitor.sh` — auto-repair liens AllDebrid expirés
- `radarr_notifier.sh` — notifie Discord si film introuvable
- `auto_repair_symlinks.sh` — répare symlinks cassés

#### Services systemd activés :
- `mount-watchdog.service`
- `repair-monitor.service`
- `radarr-notifier.service`
- `symlink-repair.timer` (horaire)

#### Webhook Discord configuré :
`https://discord.com/api/webhooks/1467261296771596445/lTFwpfpFPjnXCD5Yuk9QoAtZafZXAbZOUN8xaS-pJyUG8d5rQG02Qu8cqtiO4Bz2KM0q`

#### Documentation :
- Créé `/home/maison/media-stack/README.md`

### Skill media-server créé

Nicolas m'a demandé de créer un skill pour que j'aie toutes les infos du serveur média en tête.

**Emplacement** : `/home/maison/.openclaw/workspace/skills/media-server/SKILL.md`

Contient :
- Tous les ports/IPs des services
- API keys Radarr/Sonarr
- Commandes courantes
- Services systemd
- Troubleshooting

Ajouté à la config OpenClaw via `skills.load.extraDirs`.

### À faire par Nicolas :
- Configurer Listenarr (connexion Jellyfin)
- Vérifier profil HD-1080p dans Jellyseerr

---

## Infos techniques retenues

### Stack média complète
| Service | Port | Rôle |
|---------|------|------|
| Jellyfin | 8096 | Streaming principal |
| Plex | host | Streaming alternatif |
| Jellyseerr | 5055 | Demandes |
| Radarr | 7878 | Films |
| Sonarr | 8989 | Séries |
| Bazarr | 6767 | Sous-titres |
| Jackett | 9117 | Indexeurs |
| FlareSolverr | 8191 | Bypass Cloudflare |
| Decypharr | 8282 | Bridge AllDebrid |
| Prowlarr | 9696 | Indexeurs (backup) |
| Listenarr | 8787 | Stats |

### Chemins importants
- Stack : `/home/maison/media-stack/`
- Scripts : `/home/maison/media-stack/scripts/`
- Mount AllDebrid : `/mnt/decypharr/alldebrid/__all__` (1 PB virtuel)
- Films : `/mnt/media/movies`
- Séries : `/mnt/media/series`

### API Keys
- Radarr : `aa267f3d5f3841dbad4ddbb792f12eb8`
- Sonarr : `2f61c809f0064945bf5d05bdfe44af5a`
- Jackett : `bpr80br8i0kkgu9uflwuxxpk0p9mh1ja`

---

## Session soir (22h40-23h40)

### YggTorrent Turbo configuré dans Jackett

Nicolas m'a envoyé un fichier YAML de définition d'indexer YggTorrent (Turbo) et ses identifiants :
- **Username** : kapliphe
- **Password** : 586245

#### Problème résolu : DNS Tailscale bloquait YGG
- `www.yggtorrent.org` résolvait vers `::1` (localhost) à cause du DNS Tailscale (100.100.100.100)
- **Fix** : Ajouté `extra_hosts` dans docker-compose pour Jackett et FlareSolverr :
  ```yaml
  extra_hosts:
    - "www.yggtorrent.org:104.26.5.166"
    - "yggtorrent.org:104.26.5.166"
  ```
- Aussi ajouté dans `/etc/hosts` sur l'hôte

#### Indexer ajouté à Radarr
- URL : `http://jackett:9117/api/v2.0/indexers/yggtorrent-turbo/results/torznab/`
- Utilise le nom Docker `jackett` (pas localhost car containers isolés)

### Skill media-request créé

**Emplacement** : `/home/maison/.openclaw/workspace/skills/media-request/SKILL.md`

Workflow :
1. Recherche web pour identifier le contenu
2. Déterminer film (Radarr) ou série (Sonarr)
3. Vérifier si déjà en bibliothèque
4. Confirmer avec l'utilisateur
5. Ajouter et lancer la recherche
6. Suivre le statut et reporter

### Films ajoutés ce soir

| Film | Statut | Release |
|------|--------|---------|
| Anaconda (2025) | ✅ Téléchargé | MULTi TRUEFRENCH 1080p WEB-DL H265-Slay3R |
| Companion (2025) | ✅ Téléchargé | MULTi 1080p WEB x264-BULiTT |

Les deux sont streamés via rclone/AllDebrid (symlinks vers `/mnt/decypharr/alldebrid/__all__/`)

### Note
- YggTorrent Turbo fonctionne bien pour les recherches (50 résultats pour "matrix")
- 2 indexers YGG actifs : `yggcookie-turbo` (existant) + `yggtorrent-turbo` (nouveau)
